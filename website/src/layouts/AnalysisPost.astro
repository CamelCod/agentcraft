---
import BaseLayout from './BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import LeadCaptureForm from '../components/LeadCaptureForm.astro';
import type { AnalysisPost } from '../lib/types';

export interface Props {
  post: AnalysisPost;
}

const { post } = Astro.props;
---

<BaseLayout 
  title={`${post.title} | AgentCraft Analysis`}
  description={`${post.analysisType} analysis: ${post.title}`}
  article={true}
>
  <Header />
  
  <main class="min-h-screen">
    <article class="max-w-4xl mx-auto px-4 py-12">
      <!-- Article Header -->
      <header class="mb-8">
        <div class="flex flex-wrap gap-2 mb-4">
          <span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-medium">
            {post.analysisType}
          </span>
          <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium">
            {post.industry}
          </span>
          {post.leadMagnet && (
            <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium">
              ðŸ“¥ Free Download
            </span>
          )}
        </div>
        
        <h1 class="text-4xl md:text-5xl font-bold mb-4">{post.title}</h1>
        
        <time class="text-gray-600" datetime={post.publishedDate || ''}>
          {post.publishedDate ? new Date(post.publishedDate).toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          }) : ''}
        </time>
      </header>
      
      <!-- Key Insights -->
      {post.keyInsights.length > 0 && (
        <div class="bg-gradient-to-br from-primary-50 to-purple-50 rounded-lg p-6 mb-8">
          <h2 class="text-2xl font-bold mb-4">ðŸ”‘ Key Insights</h2>
          <ul class="space-y-2">
            {post.keyInsights.map(insight => (
              <li class="flex items-start gap-2">
                <span class="text-primary-600 font-bold">â†’</span>
                <span>{insight}</span>
              </li>
            ))}
          </ul>
        </div>
      )}
      
      <!-- Lead Magnet Form -->
      {post.leadMagnet && (
        <div class="mb-8">
          <LeadCaptureForm 
            resourceTitle={post.title}
            downloadURL={post.downloadURL || '#'}
          />
        </div>
      )}
      
      <!-- Article Content -->
      <div class="prose prose-lg max-w-none">
        <slot />
      </div>
    </article>
  </main>
  
  <Footer />
</BaseLayout>
